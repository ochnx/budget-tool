"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[516],{23516:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var r=a(3827),s=a(64090),n=a(14958),o=a(18695),l=a(49108),c=a(37805),i=a(29733),d=a(10775),m=a(95200),x=a(60585),u=a(85159),h=a(23441),p=a(22071),g=a(37211),b=a(26587),k=a(66363),f=a(38333),j=a(23356),v=a(22983),N=a(10166),y=a(98061);function w(){let[e,t]=(0,s.useState)([]),[a,w]=(0,s.useState)([]),[D,T]=(0,s.useState)(!0),[z,S]=(0,s.useState)(null),[G,M]=(0,s.useState)("month"),[Z,E]=(0,s.useState)("amount"),[C,F]=(0,s.useState)("desc"),[L,I]=(0,s.useState)(()=>{let e=new Date;return{month:e.getMonth(),year:e.getFullYear()}});async function _(){T(!0);let e=new Date;e.setMonth(e.getMonth()-6);let[a,r]=await Promise.all([n.O.from("transactions").select("*, category:categories(*)").gte("date",e.toISOString().split("T")[0]).order("date",{ascending:!1}),n.O.from("categories").select("*").order("sort_order")]);a.data&&t(a.data),r.data&&w(r.data),T(!1)}(0,s.useEffect)(()=>{_()},[]);let A=(0,s.useMemo)(()=>{let e,t,a,r;let s=new Date;if("week"===G){let n=s.getDay()||7;t=new Date(s),(e=new Date(s)).setDate(s.getDate()-n+1),e.setHours(0,0,0,0),(r=new Date(e)).setDate(r.getDate()-1),(a=new Date(r)).setDate(a.getDate()-6)}else e=new Date(L.year,L.month,1),t=new Date(L.year,L.month+1,0),a=new Date(L.year,L.month-1,1),r=new Date(L.year,L.month,0);return{start:e.toISOString().split("T")[0],end:t.toISOString().split("T")[0],prevStart:a.toISOString().split("T")[0],prevEnd:r.toISOString().split("T")[0],label:"week"===G?"Diese Woche":"".concat((0,o.ZY)(L.month)," ").concat(L.year),prevLabel:"week"===G?"Letzte Woche":(()=>{let e=0===L.month?11:L.month-1,t=0===L.month?L.year-1:L.year;return"".concat((0,o.ZY)(e)," ").concat(t)})()}},[G,L]),{currentTxs:O,prevTxs:W}=(0,s.useMemo)(()=>({currentTxs:e.filter(e=>{let t=e.date;return t>=A.start&&t<=A.end&&!e.is_income}),prevTxs:e.filter(e=>{let t=e.date;return t>=A.prevStart&&t<=A.prevEnd&&!e.is_income})}),[e,A]),Y=(0,s.useMemo)(()=>{let e=new Map;return O.forEach(t=>{let a=t.category,r=(null==a?void 0:a.id)||"uncategorized",s=e.get(r)||{id:r,name:(null==a?void 0:a.name)||"Unkategorisiert",icon:(null==a?void 0:a.icon)||"❓",color:(null==a?void 0:a.color)||"#6B7280",currentTotal:0,prevTotal:0,transactions:[],prevTransactions:[]};s.currentTotal+=Number(t.amount),s.transactions.push(t),e.set(r,s)}),W.forEach(t=>{let a=t.category,r=(null==a?void 0:a.id)||"uncategorized",s=e.get(r)||{id:r,name:(null==a?void 0:a.name)||"Unkategorisiert",icon:(null==a?void 0:a.icon)||"❓",color:(null==a?void 0:a.color)||"#6B7280",currentTotal:0,prevTotal:0,transactions:[],prevTransactions:[]};s.prevTotal+=Number(t.amount),s.prevTransactions.push(t),e.set(r,s)}),Array.from(e.values()).sort((e,t)=>t.currentTotal-e.currentTotal)},[O,W]),K=(0,s.useMemo)(()=>{let e=[];return Y.forEach(t=>{if(0===t.currentTotal)return;let a="week"===G?7:new Date(L.year,L.month+1,0).getDate(),r=t.currentTotal/a,s=365*r;if(t.prevTotal>0){let a=(t.currentTotal-t.prevTotal)/t.prevTotal*100;a>30?e.push({text:"".concat(t.icon," ").concat(t.name,": +").concat(a.toFixed(0),"% mehr als ").concat(A.prevLabel," (").concat((0,o.xG)(t.currentTotal)," vs. ").concat((0,o.xG)(t.prevTotal),")"),type:"warning"}):a<-20&&e.push({text:"".concat(t.icon," ").concat(t.name,": ").concat(Math.abs(a).toFixed(0),"% weniger als ").concat(A.prevLabel," — gut gemacht! \uD83D\uDCAA"),type:"success"})}s>500&&e.push({text:"".concat(t.icon," ").concat(t.name,": ~").concat((0,o.xG)(7*r),"/Woche = ~").concat((0,o.xG)(30*r),"/Monat = ~").concat((0,o.xG)(s),"/Jahr"),type:"info"});let n=new Map;t.transactions.forEach(e=>{let t=e.recipient||e.description||"Unbekannt";n.set(t,(n.get(t)||0)+Number(e.amount))}),n.forEach((r,s)=>{if(t.transactions.filter(e=>(e.recipient||e.description)===s).length>=3){let t=r/(a/7);t>10&&e.push({text:"Du gibst ~".concat((0,o.xG)(t),'/Woche f\xfcr "').concat(s,'" aus = ~').concat((0,o.xG)(4.33*t),"/Monat"),type:"info"})}})}),e.slice(0,12)},[Y,G,L,A]),U=t=>{let a=new Map;return e.filter(e=>{let a=e.category;return((null==a?void 0:a.id)||"uncategorized")===t&&!e.is_income}).forEach(e=>{let t=new Date(e.date),r="".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"));a.set(r,(a.get(r)||0)+Number(e.amount))}),Array.from(a.entries()).sort((e,t)=>{let[a]=e,[r]=t;return a.localeCompare(r)}).map(e=>{let[t,a]=e,[r,s]=t.split("-");return{label:"".concat((0,o.ZY)(parseInt(s)-1).slice(0,3)," ").concat(r.slice(2)),total:a}})},J=e=>{let{active:t,payload:a,label:s}=e;return t&&a&&a.length?(0,r.jsxs)("div",{className:"glass rounded-lg p-3 shadow-xl border border-dark-600",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-dark-200",children:s}),(0,r.jsx)("p",{className:"text-sm text-emerald-400 font-bold",children:(0,o.xG)(a[0].value)})]}):null};if(D)return(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-emerald-500 border-t-transparent"})});let B=O.reduce((e,t)=>e+Number(t.amount),0),P=W.reduce((e,t)=>e+Number(t.amount),0),q=P>0?(B-P)/P*100:0;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-dark-50",children:"Deep Dive"}),(0,r.jsx)("p",{className:"text-dark-400 mt-1",children:"Deine Ausgaben im Detail analysiert"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"flex bg-dark-800 rounded-xl border border-dark-700 overflow-hidden",children:[(0,r.jsx)("button",{onClick:()=>M("week"),className:"px-4 py-2 text-sm font-medium ".concat("week"===G?"bg-emerald-500/15 text-emerald-400":"text-dark-400 hover:text-dark-200"),children:"Woche"}),(0,r.jsx)("button",{onClick:()=>M("month"),className:"px-4 py-2 text-sm font-medium ".concat("month"===G?"bg-emerald-500/15 text-emerald-400":"text-dark-400 hover:text-dark-200"),children:"Monat"})]}),"month"===G&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{onClick:function(){I(e=>0===e.month?{month:11,year:e.year-1}:{...e,month:e.month-1})},className:"p-2 rounded-lg hover:bg-dark-700 text-dark-300 hover:text-dark-100",children:(0,r.jsx)(l.Z,{size:18})}),(0,r.jsxs)("span",{className:"text-sm font-medium min-w-[140px] text-center text-dark-200",children:[(0,o.ZY)(L.month)," ",L.year]}),(0,r.jsx)("button",{onClick:function(){I(e=>11===e.month?{month:0,year:e.year+1}:{...e,month:e.month+1})},className:"p-2 rounded-lg hover:bg-dark-700 text-dark-300 hover:text-dark-100",children:(0,r.jsx)(c.Z,{size:18})})]})]})]}),(0,r.jsx)("div",{className:"glass rounded-2xl p-5",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-dark-400",children:A.label}),(0,r.jsx)("p",{className:"text-2xl font-bold text-red-400",children:(0,o.xG)(B)})]}),(0,r.jsx)("div",{className:"text-center",children:P>0&&(0,r.jsxs)("div",{className:"flex items-center gap-1 px-3 py-1.5 rounded-full text-sm font-bold ".concat(q>0?"bg-red-500/10 text-red-400":"bg-emerald-500/10 text-emerald-400"),children:[q>0?(0,r.jsx)(i.Z,{size:16}):(0,r.jsx)(d.Z,{size:16}),q>0?"+":"",q.toFixed(1),"%"]})}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-sm text-dark-400",children:A.prevLabel}),(0,r.jsx)("p",{className:"text-xl font-bold text-dark-300",children:(0,o.xG)(P)})]})]})}),K.length>0&&(0,r.jsxs)("div",{className:"glass rounded-2xl p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,r.jsx)(m.Z,{size:20,className:"text-amber-400"}),"Spending Insights"]}),(0,r.jsx)("div",{className:"space-y-2",children:K.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-start gap-3 py-2.5 px-4 rounded-xl text-sm ".concat("warning"===e.type?"bg-red-500/5 border border-red-500/10 text-red-300":"success"===e.type?"bg-emerald-500/5 border border-emerald-500/10 text-emerald-300":"bg-cyan-500/5 border border-cyan-500/10 text-cyan-300"),children:[(0,r.jsx)("span",{className:"mt-0.5",children:"warning"===e.type?"⚠️":"success"===e.type?"✅":"\uD83D\uDCA1"}),(0,r.jsx)("span",{children:e.text})]},t))})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("button",{onClick:function(){"amount"===Z?E("date"):(E("amount"),F(e=>"asc"===e?"desc":"asc"))},className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-dark-400 hover:text-dark-200 hover:bg-dark-700/50",children:[(0,r.jsx)(x.Z,{size:16}),"Sortieren: ","amount"===Z?"Betrag":"Datum"," ","desc"===C?"↓":"↑"]}),(0,r.jsxs)("span",{className:"text-sm text-dark-500",children:[Y.length," Kategorien \xb7 ",O.length," Transaktionen"]})]}),(0,r.jsx)("div",{className:"space-y-3",children:Y.map(e=>{let t=z===e.id,a=e.prevTotal>0?(e.currentTotal-e.prevTotal)/e.prevTotal*100:null,s=B>0?e.currentTotal/B*100:0,n=U(e.id),l=[...e.transactions].sort((e,t)=>"amount"===Z?"desc"===C?Number(t.amount)-Number(e.amount):Number(e.amount)-Number(t.amount):"desc"===C?new Date(t.date).getTime()-new Date(e.date).getTime():new Date(e.date).getTime()-new Date(t.date).getTime()),c="week"===G?7:new Date(L.year,L.month+1,0).getDate(),i=e.currentTotal/c;return(0,r.jsxs)("div",{className:"glass rounded-2xl overflow-hidden",children:[(0,r.jsxs)("button",{onClick:()=>{var t;S(z===(t=e.id)?null:t)},className:"w-full flex items-center justify-between p-5 hover:bg-dark-700/30 text-left",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-xl",style:{backgroundColor:e.color+"20"},children:e.icon}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-dark-100",children:e.name}),(0,r.jsxs)("div",{className:"flex items-center gap-3 mt-0.5",children:[(0,r.jsxs)("span",{className:"text-xs text-dark-400",children:[e.transactions.length," Transaktionen \xb7 ",s.toFixed(1),"%"]}),null!==a&&(0,r.jsxs)("span",{className:"text-xs font-medium ".concat(a>0?"text-red-400":"text-emerald-400"),children:[a>0?"↑":"↓"," ",Math.abs(a).toFixed(0),"% vs. Vorperiode"]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-lg font-bold text-red-400",children:(0,o.xG)(e.currentTotal)}),e.prevTotal>0&&(0,r.jsxs)("p",{className:"text-xs text-dark-500",children:["Vorher: ",(0,o.xG)(e.prevTotal)]})]}),t?(0,r.jsx)(u.Z,{size:20,className:"text-dark-400"}):(0,r.jsx)(h.Z,{size:20,className:"text-dark-400"})]})]}),t&&(0,r.jsxs)("div",{className:"border-t border-dark-700/50",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 p-5 bg-dark-800/30",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-xs text-dark-500 mb-1",children:"Pro Woche"}),(0,r.jsx)("p",{className:"text-sm font-bold text-dark-200",children:(0,o.xG)(7*i)})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-xs text-dark-500 mb-1",children:"Pro Monat"}),(0,r.jsx)("p",{className:"text-sm font-bold text-dark-200",children:(0,o.xG)(30*i)})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-xs text-dark-500 mb-1",children:"Pro Jahr"}),(0,r.jsx)("p",{className:"text-sm font-bold text-amber-400",children:(0,o.xG)(365*i)})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-xs text-dark-500 mb-1",children:"\xd8 pro Transaktion"}),(0,r.jsx)("p",{className:"text-sm font-bold text-dark-200",children:(0,o.xG)(e.transactions.length>0?e.currentTotal/e.transactions.length:0)})]})]}),n.length>=2&&(0,r.jsxs)("div",{className:"p-5 border-t border-dark-700/30",children:[(0,r.jsxs)("h5",{className:"text-sm font-medium text-dark-300 mb-3 flex items-center gap-2",children:[(0,r.jsx)(p.Z,{size:16}),"Trend \xfcber Zeit"]}),(0,r.jsx)(b.h,{width:"100%",height:160,children:(0,r.jsxs)(k.w,{data:n,children:[(0,r.jsx)(f.q,{strokeDasharray:"3 3",stroke:"#334155"}),(0,r.jsx)(j.K,{dataKey:"label",tick:{fill:"#64748b",fontSize:11},axisLine:!1,tickLine:!1}),(0,r.jsx)(v.B,{tick:{fill:"#64748b",fontSize:11},axisLine:!1,tickLine:!1,tickFormatter:e=>"".concat((e/1).toFixed(0),"€")}),(0,r.jsx)(N.u,{content:(0,r.jsx)(J,{})}),(0,r.jsx)(y.x,{type:"monotone",dataKey:"total",stroke:e.color,strokeWidth:2,dot:{fill:e.color,r:4}})]})})]}),(0,r.jsx)("div",{className:"divide-y divide-dark-700/20",children:l.map(t=>(t.amount,e.transactions.filter(e=>(e.recipient||e.description)===(t.recipient||t.description)).length,(0,r.jsxs)("div",{className:"flex items-center justify-between py-3 px-5 hover:bg-dark-700/20",children:[(0,r.jsx)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-dark-100 truncate max-w-[250px]",children:t.recipient||t.description||"Unbekannt"}),(0,r.jsxs)("p",{className:"text-xs text-dark-500",children:[new Date(t.date).toLocaleDateString("de-DE",{weekday:"short",day:"2-digit",month:"2-digit"}),t.description&&t.recipient&&(0,r.jsxs)("span",{className:"ml-2 text-dark-600",children:["\xb7 ",t.description.slice(0,40)]})]})]})}),(0,r.jsxs)("span",{className:"text-sm font-bold text-red-400 flex-shrink-0",children:["-",(0,o.xG)(Number(t.amount))]})]},t.id)))})]})]},e.id)})}),0===Y.length&&(0,r.jsxs)("div",{className:"glass rounded-2xl p-12 text-center",children:[(0,r.jsx)(g.Z,{size:48,className:"mx-auto text-dark-500 mb-4"}),(0,r.jsx)("p",{className:"text-dark-400 text-lg",children:"Keine Ausgaben in diesem Zeitraum"}),(0,r.jsx)("p",{className:"text-dark-500 text-sm mt-1",children:"W\xe4hle einen anderen Zeitraum oder importiere Transaktionen"})]})]})}},18695:function(e,t,a){a.d(t,{Wd:function(){return s},ZY:function(){return o},xG:function(){return n}});let r=[{categoryName:"Miete",keywords:["miete","mietvertrag","kaltmiete","warmmiete","nebenkosten","hausverwaltung","wohnungsbau"]},{categoryName:"Lebensmittel",keywords:["rewe","edeka","aldi","lidl","netto","penny","kaufland","dm-drogerie","dm ","rossmann","supermarkt","lebensmittel","norma","real"]},{categoryName:"Klamotten",keywords:["zara","h&m","zalando","about you","aboutyou","asos","nike","adidas","cos ","uniqlo","pull&bear","bershka","massimo dutti","mango","snipes","foot locker","footlocker","mr porter","end clothing","ssense","farfetch","kickz","hhv"]},{categoryName:"Transport",keywords:["db ","deutsche bahn","bahn","deutschlandticket","mvv","uber","bolt","freenow","free now","tier","lime","voi","tankstelle","aral","shell","esso","jet tanken","adac","flixbus","taxi"]},{categoryName:"Restaurants",keywords:["restaurant","lieferando","uber eats","ubereats","wolt","doordash","mcdonalds","mcdonald","burger king","subway","starbucks","cafe","kaffee","pizz","sushi","kebab","d\xf6ner","gastronomie","bistro"]},{categoryName:"Abos & Subscriptions",keywords:["spotify","netflix","disney+","amazon prime","apple","icloud","google storage","youtube premium","crunchyroll","chatgpt","openai","notion","figma","adobe","microsoft","github","vercel","hetzner","digitalocean","cloudflare","fitnessstudio","mcfit","gym","john reed"]},{categoryName:"Gesundheit",keywords:["apotheke","arzt","praxis","krankenhaus","klinik","physiotherapie","zahnarzt","krankenkasse","tk ","aok","barmer","dak"]},{categoryName:"Entertainment",keywords:["kino","cinema","steam","playstation","xbox","nintendo","gaming","konzert","ticket","eventim","club","disco","party","festival"]},{categoryName:"Geschenke",keywords:["geschenk","blume","fleurop","amazon.de marketplace"]},{categoryName:"Gehalt",keywords:["gehalt","lohn","verg\xfctung","arbeitgeber"]},{categoryName:"Freelance",keywords:["honorar","rechnung","freelance","projekt","beratung"]}];function s(e,t,a){let s="".concat(e," ").concat(t).toLowerCase();for(let e of r)for(let t of e.keywords)if(s.includes(t.toLowerCase()))return e.categoryName;return null}function n(e){return new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e)}function o(e){return["Januar","Februar","M\xe4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"][e]}},14958:function(e,t,a){a.d(t,{O:function(){return r}});let r=(0,a(27688).eI)("https://lvhxabadywdqeepymwdm.supabase.co","sb_publishable_bF5kedUI50llEI-r1yaxIg_8Q6sauiD")}}]);